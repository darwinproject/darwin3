.. include:: ../defs.hrst

Temperature dependence
^^^^^^^^^^^^^^^^^^^^^^

Temperature functions are selected by the cpp options
:varlink:`DARWIN_TEMP_VERSION` and :varlink:`DARWIN_TEMP_RANGE`. 
The cpp option :varlink:`DARWIN_NOTEMP` turns off all temperature dependence.
The temperature dependence of mortality and grazing can be turned off for
individual plankton types by setting the traits :varlink:`tempMort`,
:varlink:`tempMort2` and :varlink:`tempGraz` to 0.


DARWIN_TEMP_VERSION 1
'''''''''''''''''''''

.. math::

   \begin{gathered}
     f^{{{\text{phy}}}}_j(T) = \left[ c_j \left[ e_{1 j}^T
         {\mathrm{e}}^{-e_{2 j} {| T - T^{\op{opt}}_j |}^{p_j}}      - n \right]_{\ge 10^{-10}}
       \right]^{\le 1}
   \\
     f^{{{\text{up}}}}_j(T) =
     f^{{{\text{graz}}}}_z(T) =
     f^{{{\text{remin}}}}(T) =
     f^{\op{mort}}(T) =
     f^{\op{mort2}}(T) =
     1\end{gathered}

where the exponential is only present with :varlink:`DARWIN_TEMP_RANGE`.


DARWIN_TEMP_VERSION 2
'''''''''''''''''''''

.. math::

   \begin{gathered}
     f^{{{\text{phy}}}}_j(T) = c^{\op{Arr}}_j \left[
         {\mathrm{e}}^{A^{\op{Arr}}_{{\mathrm{e}}}
              \bigl( (T+273.15)^{-1} - {T^{\op{Arr}}_{\op{ref}}}^{-1} \bigr)}
         {\mathrm{e}}^{-e_{2 j} {| T - T^{\op{opt}}_j |}^{p_j}}      \right]_{\ge 10^{-10}}
   \\
     f^{{{\text{up}}}}_j(T) =
     f^{{{\text{graz}}}}_z(T) =
     f^{{{\text{remin}}}}(T) =
     f^{\op{mort}}(T) =
     f^{\op{mort2}}(T) =
     f_{\op{Arr}}(T)
   \\
     f_{\op{Arr}}(T) = c^{\op{Arr}}_j \left[
         {\mathrm{e}}^{A^{\op{Arr}}_{{\mathrm{e}}}
              \bigl( (T+273.15)^{-1} - {T^{\op{Arr}}_{\op{ref}}}^{-1} \bigr)}
       \right]_{\ge 10^{-10}}\end{gathered}

where the second exponential in :math:`f^{{{\text{phy}}}}` again is only
present with :varlink:`DARWIN_TEMP_RANGE`.

Note that :math:`f^{\text{phy}}_j(T)` can be greater than 1.


DARWIN_TEMP_VERSION 3
'''''''''''''''''''''

.. math::

   \begin{gathered}
     f^{{{\text{phy}}}}_j(T) =
     f^{{{\text{up}}}}_j(T) =
     f^{{{\text{graz}}}}_z(T) =
     f^{{{\text{remin}}}}(T) =
     f^{\op{mort}}(T) =
     f^{\op{mort2}}(T) =
     f^{\op{Arr}}(T) =
     \left[ {\mathrm{e}}^{A_{{\mathrm{e}}} (T - T_{\op{ref}})} \right]_{\ge 10^{-10}}\end{gathered}

.. table:: Temperature dependence parameters
   :name: pkg_darwin_temperature_params

   +-----------------------------+--------------------------------------------------------------+-----------------------------------------------------------------------------------+
   | **Trait**                   | **Default Value**                                            | **Parameter**                                                                     |
   +=============================+==============================================================+===================================================================================+
   | **for version 1:**                                                                                                                                                             |
   +-----------------------------+--------------------------------------------------------------+-----------------------------------------------------------------------------------+
   | :varlink:`phytoTempCoeff`   | :math:`c_j=1/3`                                              | :varlink:`a_phytoTempCoeff`                                                       |
   +-----------------------------+--------------------------------------------------------------+-----------------------------------------------------------------------------------+
   | :varlink:`phytoTempExp1`    | :math:`e_{1j}=1.04`                                          | :varlink:`a_phytoTempExp1` (:math:`E_{\op{a}}=28.023\text{ kJ mol}^{-1}` at 20°C) |
   +-----------------------------+--------------------------------------------------------------+-----------------------------------------------------------------------------------+
   |                             | :math:`n=0.3`                                                | :varlink:`tempnorm`                                                               |
   +-----------------------------+--------------------------------------------------------------+-----------------------------------------------------------------------------------+
   | **for version 2:**                                                                                                                                                             |
   +-----------------------------+--------------------------------------------------------------+-----------------------------------------------------------------------------------+
   |                             | :math:`c^{\op{Arr}}=0.5882`                                  | :varlink:`TempCoeffArr`                                                           |
   +-----------------------------+--------------------------------------------------------------+-----------------------------------------------------------------------------------+
   |                             | :math:`A^{\op{Arr}}_{{\mathrm{e}}}=-4000`                    | :varlink:`TempAeArr` (:math:`E_{\op{a}}=33.257\text{ kJ mol}^{-1}`)               |
   +-----------------------------+--------------------------------------------------------------+-----------------------------------------------------------------------------------+
   |                             | :math:`T^{\op{Arr}}_{\op{ref}}=293.15`                       | :varlink:`TempRefArr`                                                             |
   +-----------------------------+--------------------------------------------------------------+-----------------------------------------------------------------------------------+
   | **for version 3:**                                                                                                                                                             |
   +-----------------------------+--------------------------------------------------------------+-----------------------------------------------------------------------------------+
   |                             | :math:`A_{{\mathrm{e}}}=0.05`                                | (:math:`E_{\op{a}}=35.725\text{ kJ mol}^{-1}` at 20°C)                            |
   +-----------------------------+--------------------------------------------------------------+-----------------------------------------------------------------------------------+
   |                             | :math:`T_{\op{ref}}=20`                                      |                                                                                   |
   +-----------------------------+--------------------------------------------------------------+-----------------------------------------------------------------------------------+
   | **for DARWIN_TEMP_RANGE:**                                                                                                                                                     |  
   +-----------------------------+--------------------------------------------------------------+-----------------------------------------------------------------------------------+
   | :varlink:`phytoTempExp2`    | :math:`e_{2j}=0.001`                                         | :varlink:`a_phytoTempExp2`                                                        |
   +-----------------------------+--------------------------------------------------------------+-----------------------------------------------------------------------------------+
   | :varlink:`phytoTempOptimum` | :math:`T^{\op{opt}}_j=2`                                     | :varlink:`a_phytoTempOptimum`                                                     |
   +-----------------------------+--------------------------------------------------------------+-----------------------------------------------------------------------------------+
   | :varlink:`phytoDecayPower`  | :math:`p_{j}=4`                                              | :varlink:`a_phytoDecayPower`                                                      |
   +-----------------------------+--------------------------------------------------------------+-----------------------------------------------------------------------------------+

(With random generation, :math:`T^{\op{opt}}_j` is drawn from
a range tempmax\ :math:`{}-{}`\ temprange\ :math:`{}\cdot[0,1]`.)

Version 3 is the same as version 1 with e\ :sub:`1` = 1.0512710963760241,
c = 0.36787944117144233, n = 0 and no DARWIN_TEMP_RANGE
or restriction to be smaller than 1.

Note that :math:`f^{\text{phy}}_j(T)` can be greater than 1.

